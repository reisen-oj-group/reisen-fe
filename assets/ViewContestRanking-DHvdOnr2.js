import{d as x,af as N,I as E,n as g,N as S,p as I,r as M,q as r,o as l,e as V,g as s,v as p,x as f,s as v,w as m,f as b,t as c,h as O,av as P,j as k,a6 as T,aL as A,_ as w,O as q,a7 as z,y as D,R as F}from"./index-CALB36uv.js";const K={class:"ranklist-container"},h={key:0,class:"ranklist"},G={class:"colgroup"},H={class:"headline entry"},J={class:"rank"},Q={class:"name"},U={class:"score-solved"},W={class:"score-penalty"},X=x({__name:"RankList",setup(R){const y=N(),n=E(()=>y.currentContest),i=E(()=>n.value?Object.keys(n.value.problems):[]),u=g([]),_=g(!1);function $(){n.value&&(_.value=!0,A({contest:n.value.id}).then(o=>{u.value=o.rankings,j()}).finally(()=>{_.value=!1}))}S(()=>{$()}),I(n,$);const C=g([]);function B(o,t){const a=o.results[t];return a?a.judge==="correct"?"solved":"attempted":""}function L(o){return o<=1?`${o} try`:`${o} tries`}function j(){if(n.value){C.value=[];for(const o of u.value){const t={rank:o.rank,user:o.user,totalPenalty:0,totalSolved:0,results:{}};for(const a of o.results)for(const e of i.value)if(n.value.problems[e]===a.problem){t.results[e]=a,a.judge==="correct"&&(t.totalPenalty+=a.penalty,t.totalSolved++);break}C.value.push(t)}}}return(o,t)=>{const a=M("router-link");return l(),r("div",K,[n.value?(l(),r("table",h,[s("colgroup",G,[t[0]||(t[0]=s("col",{class:"col-rank"},null,-1)),t[1]||(t[1]=s("col",{class:"col-name"},null,-1)),t[2]||(t[2]=s("col",{class:"col-score-solved"},null,-1)),t[3]||(t[3]=s("col",{class:"col-score-penalty"},null,-1)),(l(!0),r(p,null,f(i.value,e=>(l(),r("col",{class:"col-problem",key:e}))),128)),t[4]||(t[4]=s("col",{class:"col-empty"},null,-1))]),s("thead",null,[s("tr",H,[t[5]||(t[5]=s("th",{class:"rank"},"RANK",-1)),t[6]||(t[6]=s("th",{class:"name"},"TEAM",-1)),t[7]||(t[7]=s("th",{class:"score",colspan:"2"},"SCORE",-1)),(l(!0),r(p,null,f(i.value,e=>(l(),r("th",{class:"problem-cell",key:e},[v(a,{class:"problem",to:`/contest/${n.value.id}/problem/${n.value.problems[e]}`},{default:m(()=>[b(c(e),1)]),_:2},1032,["to"])]))),128)),t[8]||(t[8]=s("th",null,null,-1))])]),s("tbody",null,[(l(!0),r(p,null,f(C.value,e=>(l(),r("tr",{class:"normal-line entry",key:e.rank},[s("td",J,c(e.rank),1),s("td",Q,c(e.user),1),s("td",U,c(e.totalSolved),1),s("td",W,c(e.totalPenalty),1),(l(!0),r(p,null,f(i.value,d=>(l(),r("td",{class:"result-cell",key:d},[e.results[d]?(l(),r("div",{key:0,class:P(["result",B(e,d)])},[b(c(e.results[d].penalty)+" ",1),s("span",null,c(L(e.results[d].attempt)),1)],2)):O("",!0)]))),128)),t[9]||(t[9]=s("td",null,null,-1))]))),128))])])):(l(),V(k(T),{key:1,description:"暂无排行"}))])}}}),Y=w(X,[["__scopeId","data-v-e720a747"]]),Z={class:"button-container"},tt=x({__name:"ViewContestRanking",props:{cid_str:{}},setup(R){const y=z(),n=R;return S(()=>{N().enter(parseInt(n.cid_str))}),(i,u)=>(l(),V(q,null,{default:m(()=>[s("div",Z,[v(k(D),{type:"primary",class:"back-button",onClick:u[0]||(u[0]=_=>k(y).push(`/contest/${i.cid_str}`))},{default:m(()=>u[1]||(u[1]=[b(" 返回比赛 ")])),_:1})]),v(k(F),{class:"ranklist-card"},{default:m(()=>[v(Y)]),_:1})]),_:1}))}}),et=w(tt,[["__scopeId","data-v-199b4f70"]]);export{et as default};
