import{e as q,p as u,P as G,s as x,h as g,X as O,v as l,w as o,k as e,a$ as U,T as X,f as z,r as H,o as b,g as d,z as f,I as i,E as D,F as J,b0 as L,C as _,b1 as y,t as h,aq as Q,b2 as W,ay as Y,j as Z,D as ee,B as w,M as le,aA as ae,x as A,A as te,ad as oe,S as se,b3 as ne,b4 as re,_ as ue}from"./index-SVFsH89c.js";import{d as de,e as ie,f as pe}from"./user-B6gsDtEE.js";const ve={class:"user-list"},me={class:"toolbar"},fe={class:"filter-list"},ce={class:"button-container"},ge={class:"button-container"},be={class:"button-container"},ye=q({__name:"AdminUser",setup(we){const E=u([]),k=u(!1),c=u({}),r=u({current:1,size:20,total:0}),C=u(!1),s=u(),V=u(!1),v=u(""),B=n=>["","用户","裁判","管理","超管"][n]||"未知",T=n=>["","info","primary","warning","error"][n]||"",p=async()=>{k.value=!0;try{const n=await de({page:r.value.current,...c.value});E.value=n.users,r.value.total=n.total}finally{k.value=!1}},m=()=>{r.value.current=1,p()},S=()=>{s.value={id:0,name:"",role:1,avatar:""},V.value=!0,C.value=!0},I=n=>{s.value=n,V.value=!1,C.value=!0},F=n=>{se.fire({title:"确认删除吗？",text:"删除后将无法恢复！",icon:"warning",showCancelButton:!0,confirmButtonText:"确认",cancelButtonText:"取消"}).then(a=>{a.isConfirmed&&ie({user:n.id}).then(p)})},P=()=>{s.value&&ne({user:s.value,password:v.value}).then(p)},N=()=>{s.value&&pe({user:s.value}).then(p)},K=()=>{s.value&&re({user:s.value.id,oldPassword:"",newPassword:v.value})},M=n=>{};return G(()=>{p()}),(n,a)=>{const $=H("el-tag"),j=X("loading");return b(),x("div",ve,[g("div",me,[l(e(f),{type:"primary",onClick:S},{default:o(()=>a[9]||(a[9]=[d("新增用户")])),_:1}),g("div",fe,[l(e(D),{modelValue:c.value.role,"onUpdate:modelValue":a[0]||(a[0]=t=>c.value.role=t),placeholder:"用户权限",style:{width:"120px","margin-left":"10px"},clearable:"",onChange:m,onClear:m,onKeyup:U(m,["enter"])},{default:o(()=>[l(e(i),{label:"普通",value:1}),l(e(i),{label:"教练",value:2}),l(e(i),{label:"管理",value:3}),l(e(i),{label:"超管",value:4})]),_:1},8,["modelValue"]),l(e(_),{modelValue:c.value.user,"onUpdate:modelValue":a[1]||(a[1]=t=>c.value.user=t),placeholder:"用户名或 ID",style:{width:"300px","margin-left":"10px"},clearable:"",onClear:m,onKeyup:U(m,["enter"])},{append:o(()=>[l(e(J),{icon:e(L),onClick:m},null,8,["icon"])]),_:1},8,["modelValue"])])]),O((b(),z(e(W),{data:E.value,border:"",style:{width:"100%","margin-top":"20px"}},{default:o(()=>[l(e(y),{prop:"id",label:"ID",width:"80"}),l(e(y),{prop:"name",label:"名称"}),l(e(y),{prop:"role",label:"角色"},{default:o(({row:t})=>[l($,{type:T(t.role)},{default:o(()=>[d(h(B(t.role)),1)]),_:2},1032,["type"])]),_:1}),l(e(y),{prop:"register",label:"注册时间"},{default:o(({row:t})=>[d(h(e(Q)(t.createdAt)),1)]),_:1}),l(e(y),{label:"操作",width:"180"},{default:o(({row:t})=>[l(e(f),{link:"",type:"primary",size:"small",onClick:R=>I(t)},{default:o(()=>a[10]||(a[10]=[d("编辑")])),_:2},1032,["onClick"]),l(e(f),{link:"",type:"danger",size:"small",onClick:R=>F(t)},{default:o(()=>a[11]||(a[11]=[d("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[j,k.value]]),l(e(Y),{"current-page":r.value.current,"onUpdate:currentPage":a[2]||(a[2]=t=>r.value.current=t),"page-size":r.value.size,"onUpdate:pageSize":a[3]||(a[3]=t=>r.value.size=t),total:r.value.total,layout:"total, prev, pager, next, jumper","page-sizes":[10,20,50,100],onSizeChange:p,onCurrentChange:p},null,8,["current-page","page-size","total"]),l(e(oe),{"close-on-click-modal":"","show-close":"","z-index":10,modelValue:C.value,"onUpdate:modelValue":a[8]||(a[8]=t=>C.value=t),title:V.value?"创建用户":"修改信息"},{default:o(()=>[s.value?(b(),z(e(ee),{key:0,model:s.value,"label-width":"100px"},{default:o(()=>[l(e(w),{label:"用户名"},{default:o(()=>[l(e(_),{modelValue:s.value.name,"onUpdate:modelValue":a[4]||(a[4]=t=>s.value.name=t)},null,8,["modelValue"])]),_:1}),l(e(w),{label:"权限"},{default:o(()=>[l(e(D),{modelValue:s.value.role,"onUpdate:modelValue":a[5]||(a[5]=t=>s.value.role=t)},{default:o(()=>[l(e(i),{label:"普通",value:1}),l(e(i),{label:"教练",value:2}),l(e(i),{label:"管理",value:3}),l(e(i),{label:"超管",value:4})]),_:1},8,["modelValue"])]),_:1}),l(e(w),{label:"头像"},{default:o(()=>[l(e(le),{action:"/api/upload","show-file-list":!1,"on-success":M},{default:o(()=>[l(e(ae),{src:s.value.avatar},null,8,["src"])]),_:1})]),_:1}),V.value?(b(),x(A,{key:0},[l(e(w),{label:"密码"},{default:o(()=>[l(e(_),{modelValue:v.value,"onUpdate:modelValue":a[6]||(a[6]=t=>v.value=t),placeholder:"密码",type:"password","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),g("div",ce,[l(e(f),{type:"danger",onClick:P},{default:o(()=>a[12]||(a[12]=[d("创建账号")])),_:1})])],64)):(b(),x(A,{key:1},[g("div",ge,[l(e(f),{type:"primary",onClick:N},{default:o(()=>a[13]||(a[13]=[d("修改信息")])),_:1})]),l(e(te)),l(e(w),{label:"密码"},{default:o(()=>[l(e(_),{modelValue:v.value,"onUpdate:modelValue":a[7]||(a[7]=t=>v.value=t),placeholder:"密码",type:"password","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),g("div",be,[l(e(f),{type:"danger",onClick:K},{default:o(()=>a[14]||(a[14]=[d("重置密码")])),_:1})])],64))]),_:1},8,["model"])):Z("",!0)]),_:1},8,["modelValue","title"])])}}}),_e=ue(ye,[["__scopeId","data-v-f118025a"]]);export{_e as default};
