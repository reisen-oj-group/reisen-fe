import{e as x,ai as S,K as E,p as g,P as V,q as P,r as I,s as r,o as l,f as w,h as s,x as p,y as f,v,w as m,g as b,t as c,j as M,ay as O,k,a9 as T,aO as z,_ as B,Q as A,aa as K,z as q,U as D}from"./index-ByD3yNI7.js";const F={class:"ranklist-container"},Q={key:0,class:"ranklist"},U={class:"colgroup"},h={class:"headline entry"},G={class:"rank"},H={class:"name"},J={class:"score-solved"},W={class:"score-penalty"},X=x({__name:"RankList",setup(R){const y=S(),n=E(()=>y.currentContest),i=E(()=>n.value?Object.keys(n.value.problems):[]),u=g([]),_=g(!1);function $(){n.value&&(_.value=!0,z({contest:n.value.id}).then(o=>{u.value=o.rankings,L()}).finally(()=>{_.value=!1}))}V(()=>{$()}),P(n,$);const C=g([]);function N(o,t){const a=o.results[t];return a?a.judge==="correct"?"solved":"attempted":""}function j(o){return o<=1?`${o} try`:`${o} tries`}function L(){if(n.value){C.value=[];for(const o of u.value){const t={rank:o.rank,user:o.user,totalPenalty:0,totalSolved:0,results:{}};for(const a of o.results)for(const e of i.value)if(n.value.problems[e]===a.problem){t.results[e]=a,a.judge==="correct"&&(t.totalPenalty+=a.penalty,t.totalSolved++);break}C.value.push(t)}}}return(o,t)=>{const a=I("router-link");return l(),r("div",F,[n.value?(l(),r("table",Q,[s("colgroup",U,[t[0]||(t[0]=s("col",{class:"col-rank"},null,-1)),t[1]||(t[1]=s("col",{class:"col-name"},null,-1)),t[2]||(t[2]=s("col",{class:"col-score-solved"},null,-1)),t[3]||(t[3]=s("col",{class:"col-score-penalty"},null,-1)),(l(!0),r(p,null,f(i.value,e=>(l(),r("col",{class:"col-problem",key:e}))),128)),t[4]||(t[4]=s("col",{class:"col-empty"},null,-1))]),s("thead",null,[s("tr",h,[t[5]||(t[5]=s("th",{class:"rank"},"RANK",-1)),t[6]||(t[6]=s("th",{class:"name"},"TEAM",-1)),t[7]||(t[7]=s("th",{class:"score",colspan:"2"},"SCORE",-1)),(l(!0),r(p,null,f(i.value,e=>(l(),r("th",{class:"problem-cell",key:e},[v(a,{class:"problem",to:`/contest/${n.value.id}/problem/${n.value.problems[e]}`},{default:m(()=>[b(c(e),1)]),_:2},1032,["to"])]))),128)),t[8]||(t[8]=s("th",null,null,-1))])]),s("tbody",null,[(l(!0),r(p,null,f(C.value,e=>(l(),r("tr",{class:"normal-line entry",key:e.rank},[s("td",G,c(e.rank),1),s("td",H,c(e.user),1),s("td",J,c(e.totalSolved),1),s("td",W,c(e.totalPenalty),1),(l(!0),r(p,null,f(i.value,d=>(l(),r("td",{class:"result-cell",key:d},[e.results[d]?(l(),r("div",{key:0,class:O(["result",N(e,d)])},[b(c(e.results[d].penalty)+" ",1),s("span",null,c(j(e.results[d].attempt)),1)],2)):M("",!0)]))),128)),t[9]||(t[9]=s("td",null,null,-1))]))),128))])])):(l(),w(k(T),{key:1,description:"暂无排行"}))])}}}),Y=B(X,[["__scopeId","data-v-e720a747"]]),Z={class:"button-container"},tt=x({__name:"ViewContestRanking",props:{cid_str:{}},setup(R){const y=K(),n=R;return V(()=>{S().enter(parseInt(n.cid_str))}),(i,u)=>(l(),w(A,null,{default:m(()=>[s("div",Z,[v(k(q),{type:"primary",class:"back-button",onClick:u[0]||(u[0]=_=>k(y).push(`/contest/${i.cid_str}`))},{default:m(()=>u[1]||(u[1]=[b(" 返回比赛 ")])),_:1})]),v(k(D),{class:"ranklist-card"},{default:m(()=>[v(Y)]),_:1})]),_:1}))}}),et=B(tt,[["__scopeId","data-v-199b4f70"]]);export{et as default};
