import{V as K,W as ee,a as z,X as te,Y as le,d as M,l as G,n as T,I as q,Q as X,e as k,o as n,j as o,R as H,w as m,q as _,g as t,t as C,Z as oe,$ as se,a0 as ne,h as y,s as u,v as L,x as J,a1 as A,f as P,a2 as D,F as I,a3 as j,a4 as Y,a5 as ae,U as Q,a6 as re,_ as F,m as ie,a7 as N,u as ue,a8 as de,r as V,a9 as pe,aa as ce,ab as me,H as fe,y as O,ac as be,ad as ve,ae as _e,af as ge,N as ye,p as ke,ag as he,P as Ce}from"./index-CALB36uv.js";import{_ as E,C as $e}from"./ContestSidebar-DBG9dPEh.js";import"./markdown-Ptyy3W22.js";var we=1/0,Ve=17976931348623157e292;function Ie(a){if(!a)return a===0?a:0;if(a=K(a),a===we||a===-1/0){var l=a<0?-1:1;return l*Ve}return a===a?a:0}function Pe(a){var l=Ie(a),r=l%1;return l===l?r?l-r:l:0}function Te(a){return function(l,r,f){var d=Object(l);if(!ee(l)){var e=z(r);l=te(l),r=function(p){return e(d[p],p,d)}}var b=a(l,r,f);return b>-1?d[e?l[b]:b]:void 0}}var Se=Math.max;function Ee(a,l,r){var f=a==null?0:a.length;if(!f)return-1;var d=r==null?0:Pe(r);return d<0&&(d=Se(f+d,0)),le(a,z(l),d)}var Le=Te(Ee);const Me={class:"problem-header"},Be={class:"problem-title"},Fe={class:"problem-meta"},Ne={class:"time-limit"},Re={class:"memory-limit"},Ue={class:"problem-type"},Oe={class:"problem-content"},qe={key:0,class:"problem-section"},Ae={key:1,class:"problem-section"},De={key:2,class:"problem-section"},je={key:3,class:"problem-section"},Ye={key:4,class:"problem-section"},ze=["onClick"],Ge={key:0},Xe=["onClick"],He={key:0},Je={key:5,class:"problem-section"},Qe={key:0,style:{height:"200px"}},We=M({__name:"ProblemContent",props:{problem:{},loading:{type:Boolean}},setup(a){const l=a,r=G();function f(){if(l.problem!==null){const c=Object.keys(l.problem.statements);if(c.length!==0&&!(r.userLang in c))return c[0]}return r.userLang}const d=T(f()),e=q(()=>{var c;return(c=l.problem)==null?void 0:c.statements[d.value]}),b=q(()=>{var c;return((c=l.problem)==null?void 0:c.title[d.value])||"暂无题面"}),p=T(0),s=async(c,v)=>{await navigator.clipboard.writeText(v),p.value=c,setTimeout(()=>{p.value==c&&(p.value=0)},1e3)};return(c,v)=>{const R=X("loading");return n(),k(o(H),{class:"problem-container"},{default:m(()=>[c.problem&&e.value?(n(),_(L,{key:0},[t("div",Me,[t("h1",Be,C(b.value||"暂无数据"),1),t("div",Fe,[t("span",Ne,"时间限制: "+C(o(oe)(c.problem.limitTime)),1),t("span",Re,"内存限制: "+C(o(se)(c.problem.limitMemory)),1),t("span",Ue,C(o(ne)(c.problem.type)),1)])]),t("div",Oe,[e.value.background?(n(),_("div",qe,[v[0]||(v[0]=t("h2",{class:"section-title"},"题目背景",-1)),u(E,{content:e.value.background},null,8,["content"])])):y("",!0),e.value.legend?(n(),_("div",Ae,[v[1]||(v[1]=t("h2",{class:"section-title"},"题目描述",-1)),u(E,{content:e.value.legend},null,8,["content"])])):y("",!0),e.value.formatI?(n(),_("div",De,[v[2]||(v[2]=t("h2",{class:"section-title"},"输入格式",-1)),u(E,{content:e.value.formatI},null,8,["content"])])):y("",!0),e.value.formatO?(n(),_("div",je,[v[3]||(v[3]=t("h2",{class:"section-title"},"输出格式",-1)),u(E,{content:e.value.formatO},null,8,["content"])])):y("",!0),e.value.examples&&e.value.examples.length>0?(n(),_("div",Ye,[v[4]||(v[4]=t("h2",{class:"section-title"},"样例",-1)),(n(!0),_(L,null,J(e.value.examples,(g,i)=>(n(),_("div",{key:i,class:"example"},[u(o(ae),{gutter:8},{default:m(()=>[u(o(A),{span:12,class:"data"},{default:m(()=>[t("h3",null,[P(" 输入 #"+C(i+1)+" ",1),t("a",{href:"#",onClick:D($=>s(i+1,g.dataI||""),["prevent"]),class:"copy-link"},[p.value!=i+1?(n(),k(o(I),{key:0,icon:o(j)},null,8,["icon"])):(n(),k(o(I),{key:1,icon:o(Y)},null,8,["icon"]))],8,ze)]),g.dataI?(n(),_("pre",Ge,C(g.dataI),1)):y("",!0)]),_:2},1024),u(o(A),{span:12,class:"data"},{default:m(()=>[t("h3",null,[P(" 输出 #"+C(i+1)+" ",1),t("a",{href:"#",onClick:D($=>s(-i-1,g.dataO||""),["prevent"]),class:"copy-link"},[p.value!=-i-1?(n(),k(o(I),{key:0,icon:o(j)},null,8,["icon"])):(n(),k(o(I),{key:1,icon:o(Y)},null,8,["icon"]))],8,Xe)]),g.dataO?(n(),_("pre",He,C(g.dataO),1)):y("",!0)]),_:2},1024)]),_:2},1024)]))),128))])):y("",!0),e.value.hint?(n(),_("div",Je,[v[5]||(v[5]=t("h2",{class:"section-title"},"提示",-1)),u(E,{content:e.value.hint},null,8,["content"])])):y("",!0)])],64)):(n(),_(L,{key:1},[c.loading?Q((n(),_("div",Qe,null,512)),[[R,!0]]):(n(),k(o(re),{key:1,description:"暂无题面"}))],64))]),_:1})}}}),Ze=F(We,[["__scopeId","data-v-d73679b8"]]),xe={class:"dialog-footer"},Ke=M({__name:"ProblemSubmit",props:ie({problem:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const l=N(),r=a,f=ue(a,"modelValue"),{codeLangs:d}=G().config,e=de({lang:"",code:""}),b=T(!1),p=q(()=>e.lang&&e.code.trim().length>0),s=()=>{e.lang="",e.code=""},c=g=>{const i=g.raw;if(!i)return;const $=v(i.name);if(console.log($),!e.lang){const w=Le(d,S=>S.ext.includes($.toLowerCase()));w&&(e.lang=w.id)}const B=new FileReader;B.onload=w=>{var S;e.code=((S=w.target)==null?void 0:S.result)||""},B.readAsText(i),console.log(e.code)};function v(g){var $;const i=g.split(".");return i.length>1?`.${($=i.pop())==null?void 0:$.toLowerCase()}`:""}const R=async()=>{if(p.value){b.value=!0;try{const g=await me({problem:r.problem.id,lang:e.lang,code:e.code});l.push(`/record/${g.record}`),f.value=!1}catch{}finally{b.value=!1}}};return(g,i)=>{const $=V("el-option"),B=V("el-select"),w=V("el-form-item"),S=V("el-input"),U=V("el-button"),W=V("el-upload"),Z=V("el-form"),x=V("el-dialog");return n(),k(x,{modelValue:f.value,"onUpdate:modelValue":i[3]||(i[3]=h=>f.value=h),title:`提交代码 - ${g.problem.id}`,width:"800",onClose:s},{footer:m(()=>[t("div",xe,[u(U,{onClick:i[2]||(i[2]=h=>f.value=!1)},{default:m(()=>i[5]||(i[5]=[P("取消")])),_:1}),u(U,{type:"primary",onClick:R,loading:b.value,disabled:!p.value},{default:m(()=>[u(o(I),{icon:o(ce),class:"mr-2"},null,8,["icon"]),i[6]||(i[6]=P(" 提交评测 "))]),_:1},8,["loading","disabled"])])]),default:m(()=>[u(Z,{model:e,"label-width":"auto"},{default:m(()=>[u(w,{label:"编程语言",required:""},{default:m(()=>[u(B,{modelValue:e.lang,"onUpdate:modelValue":i[0]||(i[0]=h=>e.lang=h),class:"input-lang",placeholder:"选择编程语言",size:"large",filterable:""},{default:m(()=>[(n(!0),_(L,null,J(o(d),h=>(n(),k($,{key:h.id,label:h.description,value:h.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(w,{label:"代码编辑",required:""},{default:m(()=>[u(S,{modelValue:e.code,"onUpdate:modelValue":i[1]||(i[1]=h=>e.code=h),autosize:{minRows:10,maxRows:12},class:"input-code",type:"textarea",placeholder:"Your code here..."},null,8,["modelValue"])]),_:1}),u(w,{label:"或者"},{default:m(()=>[u(W,{class:"upload-demo",action:"#","auto-upload":!1,"on-change":c,"show-file-list":!1},{default:m(()=>[u(U,{type:"primary"},{default:m(()=>[u(o(I),{icon:o(pe),class:"mr-2"},null,8,["icon"]),i[4]||(i[4]=P(" 上传代码文件 "))]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),et=F(Ke,[["__scopeId","data-v-5fa88ce3"]]),tt={class:"panel-container"},lt={key:0,class:"description-list"},ot={class:"description-item"},st={class:"item-value"},nt={class:"description-item"},at={class:"item-value"},rt={key:1,style:{height:"128px"}},it=M({__name:"ProblemPanel",props:{problem:{},result:{},edit:{type:Boolean,default:!1},loading:{type:Boolean}},setup(a){const l=N(),r=fe(),f=T(!1),d=a,e=()=>{d.problem&&l.push(`/record?problem=${d.problem.id}`)},b=()=>{if(d.problem){if(!r.currentUser){r.show("login");return}l.push(`/record?problem=${d.problem.id}&user=${r.currentUser.id}`)}};return(p,s)=>{const c=X("loading");return n(),_(L,null,[t("div",tt,[u(o(H),null,{default:m(()=>[s[6]||(s[6]=t("h3",{class:"info-title"},"题目信息",-1)),p.problem?(n(),_("div",lt,[t("div",ot,[s[2]||(s[2]=t("span",{class:"item-label"},"编号",-1)),t("span",st,C(p.problem.id),1)]),t("div",nt,[s[3]||(s[3]=t("span",{class:"item-label"},"难度",-1)),t("span",at,C(p.problem.difficulty),1)]),s[4]||(s[4]=t("div",{class:"description-item"},[t("span",{class:"item-label"},"标签"),t("span",{class:"item-value"},"没写")],-1)),s[5]||(s[5]=t("div",{class:"description-item"},[t("span",{class:"item-label"},"来源"),t("span",{class:"item-value"},"没有")],-1))])):Q((n(),_("div",rt,null,512)),[[c,p.loading]])]),_:1}),u(o(O),{type:"primary",disabled:!p.problem,onClick:s[0]||(s[0]=v=>f.value=!0)},{default:m(()=>s[7]||(s[7]=[P("提交")])),_:1},8,["disabled"]),u(o(be),{fill:"","fill-ratio":40},{default:m(()=>[u(o(O),{plain:"",onClick:e},{default:m(()=>s[8]||(s[8]=[P("全部记录")])),_:1}),u(o(O),{plain:"",onClick:b},{default:m(()=>s[9]||(s[9]=[P("我的记录")])),_:1})]),_:1})]),p.problem?(n(),k(et,{key:0,problem:p.problem,modelValue:f.value,"onUpdate:modelValue":s[1]||(s[1]=v=>f.value=v)},null,8,["problem","modelValue"])):y("",!0)],64)}}}),ut=F(it,[["__scopeId","data-v-b0ba0655"]]),dt={key:0,class:"toolbar"},pt=M({__name:"ProblemToolbar",props:{problem:{},loading:{type:Boolean}},setup(a){const l=N();return(r,f)=>r.loading?y("",!0):(n(),_("div",dt,[r.problem?(n(),k(o(I),{key:0,icon:o(ve),class:"tool-icon"},null,8,["icon"])):y("",!0),r.problem?(n(),k(o(I),{key:1,icon:o(_e),class:"tool-icon",onClick:f[0]||(f[0]=d=>o(l).push(`/problem/${r.problem.id}/edit`))},null,8,["icon"])):y("",!0)]))}}),ct=F(pt,[["__scopeId","data-v-449d22aa"]]),vt=M({__name:"ViewProblemDetail",props:{plabel:{},pid_str:{},cid_str:{}},setup(a){N();const l=ge(),r=T(null),f=T(null),d=T(!1);async function e(){r.value=null,d.value=!0;let p=0;b.cid_str&&b.plabel?await l.enter(parseInt(b.cid_str)).then(()=>{p=l.currentContest.problems[b.plabel]}):b.pid_str&&(p=parseInt(b.pid_str)),p?await Ce({problem:p}).then(s=>{r.value=s.problem,s.result&&(f.value=s.result)}).finally(()=>{d.value=!1}):d.value=!1}const b=a;return ye(()=>{e()}),ke(b,()=>e()),(p,s)=>(n(),k(he,null,{main:m(()=>[u(ct,{loading:d.value,problem:r.value},null,8,["loading","problem"]),u(Ze,{loading:d.value,problem:r.value},null,8,["loading","problem"])]),sidebar:m(()=>[u($e),u(ut,{loading:d.value,problem:r.value,result:f.value},null,8,["loading","problem","result"])]),_:1}))}});export{vt as default};
