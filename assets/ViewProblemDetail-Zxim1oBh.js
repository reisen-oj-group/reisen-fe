import{Y as x,Z as ee,a as Y,$ as te,a0 as oe,e as B,n as G,p as T,K as O,T as J,f as h,o as n,k as s,U as X,w as c,s as v,h as r,t as k,a1 as le,a2 as se,a3 as ne,j as y,v as u,x as M,y as K,a4 as q,g as P,a5 as j,F as I,a6 as D,a7 as z,a8 as ae,X as Z,a9 as ie,_ as R,m as re,aa as U,u as ue,ab as de,r as V,ac as ce,ad as pe,ae as me,J as fe,z as A,af as be,ag as _e,ah as ve,ai as ge,P as ye,q as he,aj as ke,R as Ce}from"./index-D9OJ9fva.js";import{_ as L,C as $e}from"./ContestSidebar-BsRZ6Wx9.js";import"./markdown-Ca-TJ-LV.js";var we=1/0,Ve=17976931348623157e292;function Ie(a){if(!a)return a===0?a:0;if(a=x(a),a===we||a===-1/0){var o=a<0?-1:1;return o*Ve}return a===a?a:0}function Pe(a){var o=Ie(a),l=o%1;return o===o?l?o-l:o:0}function Te(a){return function(o,l,p){var d=Object(o);if(!ee(o)){var e=Y(l);o=te(o),l=function(f){return e(d[f],f,d)}}var m=a(o,l,p);return m>-1?d[e?o[m]:m]:void 0}}var Se=Math.max;function Ee(a,o,l){var p=a==null?0:a.length;if(!p)return-1;var d=l==null?0:Pe(l);return d<0&&(d=Se(p+d,0)),oe(a,Y(o),d)}var Le=Te(Ee);const Me={class:"problem-header"},Be={class:"problem-title"},Fe={class:"problem-meta"},Re={class:"time-limit"},Ue={class:"memory-limit"},Ne={class:"problem-type"},Ae={class:"problem-content"},Oe={key:0,class:"problem-section"},qe={key:1,class:"problem-section"},je={key:2,class:"problem-section"},De={key:3,class:"problem-section"},ze={key:4,class:"problem-section"},Ye=["onClick"],Ge={key:0},Je=["onClick"],Xe={key:0},Ke={key:5,class:"problem-section"},Ze={key:0,style:{height:"200px"}},He=B({__name:"ProblemContent",props:{problem:{},loading:{type:Boolean}},setup(a){const o=a,l=G();function p(){if(o.problem!==null){const t=Object.keys(o.problem.statements);if(t.length!==0&&!(l.userLang in t))return t[0]}return l.userLang}const d=T(p()),e=O(()=>{var t;return(t=o.problem)==null?void 0:t.statements[d.value]}),m=O(()=>{var t;return((t=o.problem)==null?void 0:t.title[d.value])||"暂无题面"}),f=T(0),b=async(t,_)=>{await navigator.clipboard.writeText(_),f.value=t,setTimeout(()=>{f.value==t&&(f.value=0)},1e3)};return(t,_)=>{const E=J("loading");return n(),h(s(X),{class:"problem-container"},{default:c(()=>[t.problem&&e.value?(n(),v(M,{key:0},[r("div",Me,[r("h1",Be,k(m.value||"暂无数据"),1),r("div",Fe,[r("span",Re,"时间限制: "+k(s(le)(t.problem.limitTime)),1),r("span",Ue,"内存限制: "+k(s(se)(t.problem.limitMemory)),1),r("span",Ne,k(s(ne)(t.problem.type)),1)])]),r("div",Ae,[e.value.background?(n(),v("div",Oe,[_[0]||(_[0]=r("h2",{class:"section-title"},"题目背景",-1)),u(L,{content:e.value.background},null,8,["content"])])):y("",!0),e.value.legend?(n(),v("div",qe,[_[1]||(_[1]=r("h2",{class:"section-title"},"题目描述",-1)),u(L,{content:e.value.legend},null,8,["content"])])):y("",!0),e.value.formatI?(n(),v("div",je,[_[2]||(_[2]=r("h2",{class:"section-title"},"输入格式",-1)),u(L,{content:e.value.formatI},null,8,["content"])])):y("",!0),e.value.formatO?(n(),v("div",De,[_[3]||(_[3]=r("h2",{class:"section-title"},"输出格式",-1)),u(L,{content:e.value.formatO},null,8,["content"])])):y("",!0),e.value.examples&&e.value.examples.length>0?(n(),v("div",ze,[_[4]||(_[4]=r("h2",{class:"section-title"},"样例",-1)),(n(!0),v(M,null,K(e.value.examples,(g,i)=>(n(),v("div",{key:i,class:"example"},[u(s(ae),{gutter:8},{default:c(()=>[u(s(q),{span:12,class:"data"},{default:c(()=>[r("h3",null,[P(" 输入 #"+k(i+1)+" ",1),r("a",{href:"#",onClick:j($=>b(i+1,g.dataI||""),["prevent"]),class:"copy-link"},[f.value!=i+1?(n(),h(s(I),{key:0,icon:s(D)},null,8,["icon"])):(n(),h(s(I),{key:1,icon:s(z)},null,8,["icon"]))],8,Ye)]),g.dataI?(n(),v("pre",Ge,k(g.dataI),1)):y("",!0)]),_:2},1024),u(s(q),{span:12,class:"data"},{default:c(()=>[r("h3",null,[P(" 输出 #"+k(i+1)+" ",1),r("a",{href:"#",onClick:j($=>b(-i-1,g.dataO||""),["prevent"]),class:"copy-link"},[f.value!=-i-1?(n(),h(s(I),{key:0,icon:s(D)},null,8,["icon"])):(n(),h(s(I),{key:1,icon:s(z)},null,8,["icon"]))],8,Je)]),g.dataO?(n(),v("pre",Xe,k(g.dataO),1)):y("",!0)]),_:2},1024)]),_:2},1024)]))),128))])):y("",!0),e.value.hint?(n(),v("div",Ke,[_[5]||(_[5]=r("h2",{class:"section-title"},"提示",-1)),u(L,{content:e.value.hint},null,8,["content"])])):y("",!0)])],64)):(n(),v(M,{key:1},[t.loading?Z((n(),v("div",Ze,null,512)),[[E,!0]]):(n(),h(s(ie),{key:1,description:"暂无题面"}))],64))]),_:1})}}}),Qe=R(He,[["__scopeId","data-v-d73679b8"]]),We={class:"dialog-footer"},xe=B({__name:"ProblemSubmit",props:re({problem:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const o=U(),l=a,p=ue(a,"modelValue"),{codeLangs:d}=G().config,e=de({lang:"",code:""}),m=T(!1),f=O(()=>e.lang&&e.code.trim().length>0),b=()=>{e.lang="",e.code=""},t=g=>{const i=g.raw;if(!i)return;const $=_(i.name);if(console.log($),!e.lang){const w=Le(d,S=>S.ext.includes($.toLowerCase()));w&&(e.lang=w.id)}const F=new FileReader;F.onload=w=>{var S;e.code=((S=w.target)==null?void 0:S.result)||""},F.readAsText(i),console.log(e.code)};function _(g){var $;const i=g.split(".");return i.length>1?`.${($=i.pop())==null?void 0:$.toLowerCase()}`:""}const E=async()=>{if(f.value){m.value=!0;try{const g=await me({problem:l.problem.id,lang:e.lang,code:e.code});o.push(`/submission/${g.submission}`),p.value=!1}catch{}finally{m.value=!1}}};return(g,i)=>{const $=V("el-option"),F=V("el-select"),w=V("el-form-item"),S=V("el-input"),N=V("el-button"),H=V("el-upload"),Q=V("el-form"),W=V("el-dialog");return n(),h(W,{modelValue:p.value,"onUpdate:modelValue":i[3]||(i[3]=C=>p.value=C),title:`提交代码 - ${g.problem.id}`,width:"800",onClose:b},{footer:c(()=>[r("div",We,[u(N,{onClick:i[2]||(i[2]=C=>p.value=!1)},{default:c(()=>i[5]||(i[5]=[P("取消")])),_:1}),u(N,{type:"primary",onClick:E,loading:m.value,disabled:!f.value},{default:c(()=>[u(s(I),{icon:s(pe),class:"mr-2"},null,8,["icon"]),i[6]||(i[6]=P(" 提交评测 "))]),_:1},8,["loading","disabled"])])]),default:c(()=>[u(Q,{model:e,"label-width":"auto"},{default:c(()=>[u(w,{label:"编程语言",required:""},{default:c(()=>[u(F,{modelValue:e.lang,"onUpdate:modelValue":i[0]||(i[0]=C=>e.lang=C),class:"input-lang",placeholder:"选择编程语言",size:"large",filterable:""},{default:c(()=>[(n(!0),v(M,null,K(s(d),C=>(n(),h($,{key:C.id,label:C.description,value:C.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(w,{label:"代码编辑",required:""},{default:c(()=>[u(S,{modelValue:e.code,"onUpdate:modelValue":i[1]||(i[1]=C=>e.code=C),autosize:{minRows:10,maxRows:12},class:"input-code",type:"textarea",placeholder:"Your code here..."},null,8,["modelValue"])]),_:1}),u(w,{label:"或者"},{default:c(()=>[u(H,{class:"upload-demo",action:"#","auto-upload":!1,"on-change":t,"show-file-list":!1},{default:c(()=>[u(N,{type:"primary"},{default:c(()=>[u(s(I),{icon:s(ce),class:"mr-2"},null,8,["icon"]),i[4]||(i[4]=P(" 上传代码文件 "))]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),et=R(xe,[["__scopeId","data-v-6cc8fa33"]]),tt={class:"panel-container"},ot={key:0,class:"description-list"},lt={class:"description-item"},st={class:"item-value"},nt={class:"description-item"},at={class:"item-value"},it={class:"description-item"},rt={class:"item-value"},ut={key:1,style:{height:"128px"}},dt=B({__name:"ProblemPanel",props:{problem:{},result:{},edit:{type:Boolean,default:!1},loading:{type:Boolean}},setup(a){const o=U(),l=fe(),p=T(!1);function d(){l.isAuthenticated?p.value=!0:l.show("login")}const e=a,m=()=>{e.problem&&o.push(`/submission?problem=${e.problem.id}`)},f=()=>{if(e.problem){if(!l.currentUser){l.show("login");return}o.push(`/submission?problem=${e.problem.id}&user=${l.currentUser.id}`)}};return(b,t)=>{const _=J("loading");return n(),v(M,null,[r("div",tt,[u(s(X),null,{default:c(()=>[t[4]||(t[4]=r("h3",{class:"info-title"},"题目信息",-1)),b.problem?(n(),v("div",ot,[r("div",lt,[t[1]||(t[1]=r("span",{class:"item-label"},"编号",-1)),r("span",st,k(b.problem.id),1)]),r("div",nt,[t[2]||(t[2]=r("span",{class:"item-label"},"难度",-1)),r("span",at,k(b.problem.difficulty),1)]),r("div",it,[t[3]||(t[3]=r("span",{class:"item-label"},"来源",-1)),r("span",rt,k(b.problem.provider),1)])])):Z((n(),v("div",ut,null,512)),[[_,b.loading]])]),_:1}),u(s(A),{type:"primary",disabled:!b.problem,onClick:d},{default:c(()=>t[5]||(t[5]=[P("提交")])),_:1},8,["disabled"]),u(s(be),{fill:"","fill-ratio":40},{default:c(()=>[u(s(A),{plain:"",onClick:m},{default:c(()=>t[6]||(t[6]=[P("全部记录")])),_:1}),u(s(A),{plain:"",onClick:f},{default:c(()=>t[7]||(t[7]=[P("我的记录")])),_:1})]),_:1})]),b.problem?(n(),h(et,{key:0,problem:b.problem,modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=E=>p.value=E)},null,8,["problem","modelValue"])):y("",!0)],64)}}}),ct=R(dt,[["__scopeId","data-v-150d6c28"]]),pt={key:0,class:"toolbar"},mt=B({__name:"ProblemToolbar",props:{problem:{},loading:{type:Boolean}},setup(a){const o=U();return(l,p)=>l.loading?y("",!0):(n(),v("div",pt,[l.problem?(n(),h(s(I),{key:0,icon:s(_e),class:"tool-icon"},null,8,["icon"])):y("",!0),l.problem?(n(),h(s(I),{key:1,icon:s(ve),class:"tool-icon",onClick:p[0]||(p[0]=d=>s(o).push(`/problem/${l.problem.id}/edit`))},null,8,["icon"])):y("",!0)]))}}),ft=R(mt,[["__scopeId","data-v-449d22aa"]]),gt=B({__name:"ViewProblemDetail",props:{plabel:{},pid_str:{},cid_str:{}},setup(a){U();const o=ge(),l=T(null),p=T(null),d=T(!1);async function e(){l.value=null,d.value=!0;let f=0;m.cid_str&&m.plabel?await o.enter(parseInt(m.cid_str)).then(()=>{f=o.currentContest.problems[m.plabel]}):m.pid_str&&(f=parseInt(m.pid_str)),f?await Ce({problem:f}).then(b=>{l.value=b.problem,b.result&&(p.value=b.result)}).finally(()=>{d.value=!1}):d.value=!1}const m=a;return ye(()=>{e()}),he(m,()=>e()),(f,b)=>(n(),h(ke,null,{main:c(()=>[u(ft,{loading:d.value,problem:l.value},null,8,["loading","problem"]),u(Qe,{loading:d.value,problem:l.value},null,8,["loading","problem"])]),sidebar:c(()=>[u($e),u(ct,{loading:d.value,problem:l.value,result:p.value},null,8,["loading","problem","result"])]),_:1}))}});export{gt as default};
