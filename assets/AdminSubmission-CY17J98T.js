import{e as D,n as I,p as g,P as A,s as y,h as C,X as U,v as l,a$ as w,k as t,w as i,T as j,f as x,b9 as M,o as b,C as _,x as N,y as F,I as K,E as L,g as o,F as O,b0 as P,z as v,b1 as n,t as m,aq as $,ap as q,a1 as R,a2 as G,b2 as X,ay as H,S as z,ba as J,O as S,bb as Q,_ as W}from"./index-SVFsH89c.js";const Y={class:"submission-list"},Z={class:"toolbar"},ee={class:"filter-list"},te=D({__name:"AdminSubmission",setup(ae){const{codeLangs:V,verdicts:k}=I().config,h=g([]),f=g(!1),r=g({}),s=g({current:1,size:20,total:0}),p=async()=>{f.value=!0;try{const d=await M({page:s.value.current,size:s.value.size,...r.value});h.value=d.submissions,s.value.total=d.total}finally{f.value=!1}},u=()=>{s.value.current=1,p()},B=d=>{z.fire({title:"确认重测吗？",text:"这将重新评测此提交记录",icon:"question",showCancelButton:!0,confirmButtonText:"确认",cancelButtonText:"取消"}).then(a=>{a.isConfirmed&&J({id:d.id}).then(()=>{S.success("重测请求已提交"),p()})})},E=d=>{z.fire({title:"确认删除吗？",text:"删除后将无法恢复！",icon:"warning",showCancelButton:!0,confirmButtonText:"确认",cancelButtonText:"取消"}).then(a=>{a.isConfirmed&&Q({id:d.id}).then(()=>{S.success("删除成功"),p()})})};return A(()=>{p()}),(d,a)=>{const T=j("loading");return b(),y("div",Y,[C("div",Z,[C("div",ee,[l(t(_),{modelValue:r.value.user,"onUpdate:modelValue":a[0]||(a[0]=e=>r.value.user=e),placeholder:"用户ID或名称",style:{width:"200px","margin-right":"10px"},clearable:"",onClear:u,onKeyup:w(u,["enter"])},null,8,["modelValue"]),l(t(_),{modelValue:r.value.problem,"onUpdate:modelValue":a[1]||(a[1]=e=>r.value.problem=e),placeholder:"题目ID",style:{width:"120px","margin-right":"10px"},clearable:"",onClear:u,onKeyup:w(u,["enter"])},null,8,["modelValue"]),l(t(L),{modelValue:r.value.verdict,"onUpdate:modelValue":a[2]||(a[2]=e=>r.value.verdict=e),placeholder:"评测结果",style:{width:"150px","margin-right":"10px"},clearable:"",onChange:u,onClear:u},{default:i(()=>[(b(!0),y(N,null,F(t(k),e=>(b(),x(t(K),{key:e.id,label:e.description,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(t(v),{type:"primary",onClick:u},{default:i(()=>[l(t(O),{icon:t(P)},null,8,["icon"]),a[5]||(a[5]=o(" 搜索 "))]),_:1})])]),U((b(),x(t(X),{data:h.value,border:"",style:{width:"100%","margin-top":"20px"}},{default:i(()=>[l(t(n),{prop:"id",label:"ID",width:"80"}),l(t(n),{prop:"submittedAt",label:"提交时间",width:"180"},{default:i(({row:e})=>[o(m(t($)(e.submittedAt)),1)]),_:1}),l(t(n),{prop:"user.name",label:"用户",width:"150"}),l(t(n),{prop:"problem.title",label:"题目",width:"auto"},{default:i(({row:e})=>[o(m(e.problem.title["zh-CN"]??Object.values(e.problem.title)[0]??"暂无标题"),1)]),_:1}),l(t(n),{prop:"lang",label:"语言",width:"150"},{default:i(({row:e})=>{var c;return[o(m(((c=t(V)[e.lang])==null?void 0:c.description)??"未知语言"),1)]}),_:1}),l(t(n),{prop:"verdict",label:"结果",width:"120"},{default:i(({row:e})=>[l(q,{verdict:e.verdict},null,8,["verdict"])]),_:1}),l(t(n),{prop:"time",label:"用时",width:"100",align:"right"},{default:i(({row:e})=>[o(m(t(R)(e.time)),1)]),_:1}),l(t(n),{prop:"memory",label:"内存",width:"100",align:"right"},{default:i(({row:e})=>[o(m(t(G)(e.memory)),1)]),_:1}),l(t(n),{label:"操作",width:"120",fixed:"right"},{default:i(({row:e})=>[l(t(v),{link:"",type:"primary",size:"small",onClick:c=>B(e)},{default:i(()=>a[6]||(a[6]=[o("重测")])),_:2},1032,["onClick"]),l(t(v),{link:"",type:"danger",size:"small",onClick:c=>E(e)},{default:i(()=>a[7]||(a[7]=[o("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[T,f.value]]),l(t(H),{"current-page":s.value.current,"onUpdate:currentPage":a[3]||(a[3]=e=>s.value.current=e),"page-size":s.value.size,"onUpdate:pageSize":a[4]||(a[4]=e=>s.value.size=e),total:s.value.total,layout:"total, prev, pager, next, jumper","page-sizes":[10,20,50,100],onSizeChange:p,onCurrentChange:p},null,8,["current-page","page-size","total"])])}}}),ie=W(te,[["__scopeId","data-v-03dfb6b3"]]);export{ie as default};
