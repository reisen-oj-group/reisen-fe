import{e as $,p as u,P as G,s as x,h as g,X as O,v as l,w as o,k as e,aU as U,T as W,f as z,r as Y,o as y,g as d,z as f,I as i,E as D,F as Z,aV as q,C as _,aW as b,t as h,ap as H,aX as J,av as L,j as Q,D as ee,B as w,M as le,ax as ae,x as B,A as te,ao as oe,S as se,aY as ne,aZ as re,_ as ue}from"./index-Dm7ZEwUe.js";import{c as de,d as ie,e as pe}from"./user-wCb7peZO.js";const ve={class:"user-list"},me={class:"toolbar"},fe={class:"filter-list"},ce={class:"button-container"},ge={class:"button-container"},ye={class:"button-container"},be=$({__name:"AdminUser",setup(we){const E=u([]),k=u(!1),c=u({}),r=u({current:1,size:20,total:0}),V=u(!1),s=u(),C=u(!1),v=u(""),T=n=>["","用户","裁判","管理","超管"][n]||"未知",S=n=>["","info","primary","warning","error"][n]||"",p=async()=>{k.value=!0;try{const n=await de({page:r.value.current,...c.value});E.value=n.users,r.value.total=n.total}finally{k.value=!1}},m=()=>{r.value.current=1,p()},A=()=>{s.value={id:0,name:"",role:1,avatar:""},C.value=!0,V.value=!0},I=n=>{s.value=n,C.value=!1,V.value=!0},F=n=>{se.fire({title:"确认删除吗？",text:"删除后将无法恢复！",icon:"warning",showCancelButton:!0,confirmButtonText:"确认",cancelButtonText:"取消"}).then(a=>{ie({user:n.id}).then(p)})},P=()=>{s.value&&ne({user:s.value,password:v.value}).then(p)},N=()=>{s.value&&pe({user:s.value}).then(p)},K=()=>{s.value&&re({user:s.value.id,oldPassword:"",newPassword:v.value})},M=n=>{};return G(()=>{p()}),(n,a)=>{const j=Y("el-tag"),R=W("loading");return y(),x("div",ve,[g("div",me,[l(e(f),{type:"primary",onClick:A},{default:o(()=>a[9]||(a[9]=[d("新增用户")])),_:1}),g("div",fe,[l(e(D),{modelValue:c.value.role,"onUpdate:modelValue":a[0]||(a[0]=t=>c.value.role=t),placeholder:"用户权限",style:{width:"120px","margin-left":"10px"},clearable:"",onChange:m,onClear:m,onKeyup:U(m,["enter"])},{default:o(()=>[l(e(i),{label:"普通",value:1}),l(e(i),{label:"教练",value:2}),l(e(i),{label:"管理",value:3}),l(e(i),{label:"超管",value:4})]),_:1},8,["modelValue"]),l(e(_),{modelValue:c.value.user,"onUpdate:modelValue":a[1]||(a[1]=t=>c.value.user=t),placeholder:"用户名或 ID",style:{width:"300px","margin-left":"10px"},clearable:"",onClear:m,onKeyup:U(m,["enter"])},{append:o(()=>[l(e(Z),{icon:e(q),onClick:m},null,8,["icon"])]),_:1},8,["modelValue"])])]),O((y(),z(e(J),{data:E.value,border:"",style:{width:"100%","margin-top":"20px"}},{default:o(()=>[l(e(b),{prop:"id",label:"ID",width:"80"}),l(e(b),{prop:"name",label:"名称"}),l(e(b),{prop:"role",label:"角色"},{default:o(({row:t})=>[l(j,{type:S(t.role)},{default:o(()=>[d(h(T(t.role)),1)]),_:2},1032,["type"])]),_:1}),l(e(b),{prop:"register",label:"注册时间"},{default:o(({row:t})=>[d(h(e(H)(t.register)),1)]),_:1}),l(e(b),{label:"操作",width:"180"},{default:o(({row:t})=>[l(e(f),{link:"",type:"primary",size:"small",onClick:X=>I(t)},{default:o(()=>a[10]||(a[10]=[d("编辑")])),_:2},1032,["onClick"]),l(e(f),{link:"",type:"danger",size:"small",onClick:X=>F(t)},{default:o(()=>a[11]||(a[11]=[d("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[R,k.value]]),l(e(L),{"current-page":r.value.current,"onUpdate:currentPage":a[2]||(a[2]=t=>r.value.current=t),"page-size":r.value.size,"onUpdate:pageSize":a[3]||(a[3]=t=>r.value.size=t),total:r.value.total,layout:"total, prev, pager, next, jumper","page-sizes":[10,20,50,100],onSizeChange:p,onCurrentChange:p},null,8,["current-page","page-size","total"]),l(e(oe),{"close-on-click-modal":"","show-close":"","z-index":10,modelValue:V.value,"onUpdate:modelValue":a[8]||(a[8]=t=>V.value=t),title:C.value?"创建用户":"修改信息"},{default:o(()=>[s.value?(y(),z(e(ee),{key:0,model:s.value,"label-width":"100px"},{default:o(()=>[l(e(w),{label:"用户名"},{default:o(()=>[l(e(_),{modelValue:s.value.name,"onUpdate:modelValue":a[4]||(a[4]=t=>s.value.name=t)},null,8,["modelValue"])]),_:1}),l(e(w),{label:"权限"},{default:o(()=>[l(e(D),{modelValue:s.value.role,"onUpdate:modelValue":a[5]||(a[5]=t=>s.value.role=t)},{default:o(()=>[l(e(i),{label:"普通",value:1}),l(e(i),{label:"教练",value:2}),l(e(i),{label:"管理",value:3}),l(e(i),{label:"超管",value:4})]),_:1},8,["modelValue"])]),_:1}),l(e(w),{label:"头像"},{default:o(()=>[l(e(le),{action:"/api/upload","show-file-list":!1,"on-success":M},{default:o(()=>[l(e(ae),{src:s.value.avatar},null,8,["src"])]),_:1})]),_:1}),C.value?(y(),x(B,{key:0},[l(e(w),{label:"密码"},{default:o(()=>[l(e(_),{modelValue:v.value,"onUpdate:modelValue":a[6]||(a[6]=t=>v.value=t),placeholder:"密码",type:"password","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),g("div",ce,[l(e(f),{type:"danger",onClick:P},{default:o(()=>a[12]||(a[12]=[d("创建账号")])),_:1})])],64)):(y(),x(B,{key:1},[g("div",ge,[l(e(f),{type:"primary",onClick:N},{default:o(()=>a[13]||(a[13]=[d("修改信息")])),_:1})]),l(e(te)),l(e(w),{label:"密码"},{default:o(()=>[l(e(_),{modelValue:v.value,"onUpdate:modelValue":a[7]||(a[7]=t=>v.value=t),placeholder:"密码",type:"password","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),g("div",ye,[l(e(f),{type:"danger",onClick:K},{default:o(()=>a[14]||(a[14]=[d("重置密码")])),_:1})])],64))]),_:1},8,["model"])):Q("",!0)]),_:1},8,["modelValue","title"])])}}}),_e=ue(be,[["__scopeId","data-v-e8a3dce1"]]);export{_e as default};
