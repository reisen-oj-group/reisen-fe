import{e as S,r as T,s as _,o as d,v as e,w as t,g as c,k as l,U as D,_ as B,aa as L,p as k,P as G,a4 as I,h as s,f as $,z as V,x as E,y as q,t as U,F as K,ah as Q,ar as W,a8 as J,as as h,J as O,D as M,B as g,C as x,at as R,M as H,O as F,K as X,Q as Y,j as Z,ap as ee,V as A,W as z}from"./index-D9OJ9fva.js";import{a as le}from"./user-B-REAIzI.js";const te={class:"practice-tab"},ae=S({__name:"TabPractice",props:{user:{}},setup(P){return(v,r)=>{const o=T("el-empty");return d(),_("div",te,[e(l(D),{class:"section"},{header:t(()=>r[0]||(r[0]=[c(" 参加的比赛 ")])),default:t(()=>[e(o,{description:"暂无比赛数据"})]),_:1})])}}}),j=B(ae,[["__scopeId","data-v-3bdb2350"]]),se={class:"problem-tab"},oe={class:"panel-header"},ue={class:"problemset"},ne={class:"id"},re={class:"problem"},de={class:"submit"},ie={class:"status"},pe={class:"edit"},me={class:"panel-header"},ce=S({__name:"TabProblem",props:{user:{}},setup(P){const v=L(),r=P,o=k({current:1,size:20,total:0}),i=k([]),n=k(!1),b=async()=>{n.value=!0;try{const f=await h({provider:r.user.id,page:o.value.current});i.value=f.problems,o.value.total=f.total}finally{n.value=!1}},C=f=>({public:"公开",private:"私有",contest:"比赛"})[f]||"未知";function y(){v.push("/problem/create")}function w(f){v.push(`/problem/${f}/edit`)}return G(()=>{b()}),(f,u)=>{const a=T("router-link"),p=T("el-empty"),N=T("el-card");return d(),_("div",se,[e(l(J),{gutter:20},{default:t(()=>[e(l(I),{md:12,sm:24},{default:t(()=>[e(N,{class:"panel"},{default:t(()=>[s("div",oe,[u[3]||(u[3]=s("h3",null,"我创建的题目",-1)),e(l(V),{type:"primary",size:"small",onClick:y},{default:t(()=>u[2]||(u[2]=[c("新建题目")])),_:1})]),i.value.length>0?(d(),_(E,{key:0},[s("table",ue,[u[4]||(u[4]=s("colgroup",null,[s("col",{class:"col-id"}),s("col",{class:"col-title"}),s("col",{class:"col-submit"}),s("col",{class:"col-status"}),s("col",{class:"col-edit"})],-1)),s("tbody",null,[(d(!0),_(E,null,q(i.value,m=>(d(),_("tr",{class:"entry",key:m.id},[s("td",ne,U(m.id),1),s("td",re,[e(a,{to:`/problem/${m.id}`,class:"problem-title"},{default:t(()=>[c(U(m.title["zh-CN"]||Object.values(m.title)[0]||"暂无标题"),1)]),_:2},1032,["to"])]),s("td",de,U(m.countTotal)+" 提交",1),s("td",ie,U(C(m.status)),1),s("td",pe,[e(l(K),{icon:l(Q),onClick:Ce=>w(m.id)},null,8,["icon","onClick"])])]))),128))])]),e(l(W),{"current-page":o.value.current,"onUpdate:currentPage":u[0]||(u[0]=m=>o.value.current=m),"page-size":o.value.size,"onUpdate:pageSize":u[1]||(u[1]=m=>o.value.size=m),total:o.value.total,layout:"total, prev, pager, next, jumper",onSizeChange:b,onCurrentChange:b},null,8,["current-page","page-size","total"])],64)):(d(),$(p,{key:1,description:"暂无题目数据"}))]),_:1})]),_:1}),e(l(I),{md:12,sm:24},{default:t(()=>[e(N,{class:"panel"},{default:t(()=>[s("div",me,[u[6]||(u[6]=s("h3",null,"我创建的比赛",-1)),e(l(V),{type:"primary",size:"small"},{default:t(()=>u[5]||(u[5]=[c("新建比赛")])),_:1})]),e(p,{description:"暂无比赛数据"})]),_:1})]),_:1})]),_:1})])}}}),fe=B(ce,[["__scopeId","data-v-a7ca33cf"]]),_e={class:"settings-tab"},ve=S({__name:"TabSettings",props:{user:{}},setup(P){const v=O(),r=L(),o=P,i=k({username:o.user.name,email:"user@example.com"}),n=k({old:"",new:"",confirm:""}),b=k(o.user.avatar);function C(){v.logout().then(()=>{r.push("/")})}function y(){}function w(){F.success("密码已修改")}function f(u){b.value=u.url,F.success("头像上传成功")}return(u,a)=>(d(),_("div",_e,[e(l(D),null,{default:t(()=>[e(l(J),{gutter:48},{default:t(()=>[e(l(I),{span:12,class:"safety"},{default:t(()=>[a[10]||(a[10]=s("h3",null,"账号设置",-1)),e(l(M),{"label-width":"80px"},{default:t(()=>[e(l(g),{label:"用户名"},{default:t(()=>[e(l(x),{modelValue:i.value.username,"onUpdate:modelValue":a[0]||(a[0]=p=>i.value.username=p)},null,8,["modelValue"])]),_:1}),e(l(g),{label:"电子邮箱"},{default:t(()=>[e(l(x),{modelValue:i.value.email,"onUpdate:modelValue":a[1]||(a[1]=p=>i.value.email=p)},null,8,["modelValue"]),e(l(V),{size:"small",type:"text"},{default:t(()=>a[5]||(a[5]=[c("验证邮箱")])),_:1})]),_:1}),e(l(g),null,{default:t(()=>[e(l(V),{type:"primary",onClick:y},{default:t(()=>a[6]||(a[6]=[c("保存更改")])),_:1})]),_:1})]),_:1}),a[11]||(a[11]=s("h3",null,"密码安全",-1)),e(l(M),{"label-width":"80px"},{default:t(()=>[e(l(g),{label:"当前密码"},{default:t(()=>[e(l(x),{modelValue:n.value.old,"onUpdate:modelValue":a[2]||(a[2]=p=>n.value.old=p),type:"password"},null,8,["modelValue"])]),_:1}),e(l(g),{label:"新密码"},{default:t(()=>[e(l(x),{modelValue:n.value.new,"onUpdate:modelValue":a[3]||(a[3]=p=>n.value.new=p),type:"password"},null,8,["modelValue"])]),_:1}),e(l(g),{label:"确认密码"},{default:t(()=>[e(l(x),{modelValue:n.value.confirm,"onUpdate:modelValue":a[4]||(a[4]=p=>n.value.confirm=p),type:"password"},null,8,["modelValue"])]),_:1}),e(l(g),null,{default:t(()=>[e(l(V),{type:"primary",onClick:w},{default:t(()=>a[7]||(a[7]=[c("修改密码")])),_:1})]),_:1})]),_:1}),a[12]||(a[12]=s("h3",null,"账号安全",-1)),e(l(M),{"label-width":"80px"},{default:t(()=>[e(l(g),null,{default:t(()=>[e(l(V),{type:"danger",onClick:C},{default:t(()=>a[8]||(a[8]=[c("退出登录")])),_:1}),e(l(V),{type:"danger",onClick:C},{default:t(()=>a[9]||(a[9]=[c("注销账号")])),_:1})]),_:1})]),_:1})]),_:1}),e(l(I),{span:12,class:"avatar-upload"},{default:t(()=>[e(l(R),{size:150,src:b.value},null,8,["src"]),e(l(H),{action:"/api/upload/avatar","show-file-list":!1,"on-success":f},{default:t(()=>[e(l(V),{type:"primary"},{default:t(()=>a[13]||(a[13]=[c("上传新头像")])),_:1})]),_:1}),a[14]||(a[14]=s("p",{class:"tip"},"支持 JPG/PNG 格式，大小不超过 2MB",-1))]),_:1})]),_:1})]),_:1})]))}}),be=B(ve,[["__scopeId","data-v-849d5403"]]),ye={class:"user-profile"},ge={class:"user-header"},Ve={class:"user-meta"},ke=S({__name:"ViewUser",props:{uid_str:{}},setup(P){const v=P,r=O().currentUser,o=k(null),i=v.uid_str?parseInt(v.uid_str):(r==null?void 0:r.id)||0,n=k("practice"),b=X(()=>(r==null?void 0:r.id)===i);return G(()=>{le({user:i}).then(C=>{o.value=C.user})}),(C,y)=>(d(),$(Y,null,{default:t(()=>[s("div",ye,[o.value?(d(),_(E,{key:0},[l(i)===0?(d(),_(E,{key:0},[c(" 尚未登录。 ")],64)):(d(),_(E,{key:1},[s("div",ge,[e(l(R),{size:120,src:o.value.avatar},null,8,["src"]),s("h1",null,U(o.value.name),1),s("div",Ve,[s("span",null,"注册于 "+U(l(ee)(o.value.register)),1)])]),b.value?(d(),$(l(A),{key:0,modelValue:n.value,"onUpdate:modelValue":y[0]||(y[0]=w=>n.value=w),class:"profile-tabs"},{default:t(()=>[e(l(z),{label:"练习",name:"practice"},{default:t(()=>[e(j,{user:o.value},null,8,["user"])]),_:1}),e(l(z),{label:"题库",name:"problems"},{default:t(()=>[e(fe,{user:o.value},null,8,["user"])]),_:1}),e(l(z),{label:"设置",name:"settings"},{default:t(()=>[e(be,{user:o.value},null,8,["user"])]),_:1})]),_:1},8,["modelValue"])):(d(),$(l(A),{key:1,modelValue:n.value,"onUpdate:modelValue":y[1]||(y[1]=w=>n.value=w),class:"profile-tabs"},{default:t(()=>[e(l(z),{label:"练习",name:"practice"},{default:t(()=>[e(j,{user:o.value},null,8,["user"])]),_:1})]),_:1},8,["modelValue"]))],64))],64)):Z("",!0)])]),_:1}))}}),Ue=B(ke,[["__scopeId","data-v-11422884"]]);export{Ue as default};
