import{Y as ee,Z as te,a as Y,$ as oe,a0 as le,e as B,n as G,p as T,K as O,T as X,f as h,o as s,k as l,U as K,w as p,s as v,h as i,t as k,a1 as ne,a2 as se,a3 as ae,j as y,v as r,x as j,y as Z,a4 as q,g as I,a5 as D,F as V,a6 as z,a7 as J,a8 as ie,X as H,a9 as re,_ as F,m as ue,aa as U,ab as Q,u as de,ac as me,r as P,ad as pe,ae as ce,af as be,ag as fe,J as _e,A as N,ah as ve,ai as ge,aj as ye,P as he,q as ke,ak as Ce,R as $e}from"./index-DTUDYeuU.js";import{_ as M,C as we}from"./ContestSidebar-BlTjrq9k.js";import"./markdown-O7Rz5C9z.js";var Ve=1/0,Ie=17976931348623157e292;function Pe(a){if(!a)return a===0?a:0;if(a=ee(a),a===Ve||a===-1/0){var n=a<0?-1:1;return n*Ie}return a===a?a:0}function Te(a){var n=Pe(a),e=n%1;return n===n?e?n-e:n:0}function Se(a){return function(n,e,c){var m=Object(n);if(!te(n)){var o=Y(e);n=oe(n),e=function(b){return o(m[b],b,m)}}var u=a(n,e,c);return u>-1?m[o?n[u]:u]:void 0}}var Ee=Math.max;function Le(a,n,e){var c=a==null?0:a.length;if(!c)return-1;var m=e==null?0:Te(e);return m<0&&(m=Ee(c+m,0)),le(a,Y(n),m)}var Me=Se(Le);const je={class:"problem-header"},Be={class:"problem-title"},Re={class:"problem-meta"},Fe={class:"time-limit"},Ue={class:"memory-limit"},Ae={class:"problem-type"},Ne={class:"problem-content"},Oe={key:0,class:"problem-section"},qe={key:1,class:"problem-section"},De={key:2,class:"problem-section"},ze={key:3,class:"problem-section"},Je={key:4,class:"problem-section"},Ye=["onClick"],Ge={key:0},Xe=["onClick"],Ke={key:0},Ze={key:5,class:"problem-section"},He={key:0,style:{height:"200px"}},Qe=B({__name:"ProblemContent",props:{problem:{},loading:{type:Boolean}},setup(a){const n=a,e=G();function c(){if(n.problem!==null){const t=Object.keys(n.problem.statements);if(t.length!==0&&!(e.userLang in t))return t[0]}return e.userLang}const m=T(c()),o=O(()=>{var t;return(t=n.problem)==null?void 0:t.statements[m.value]}),u=O(()=>{var t;return((t=n.problem)==null?void 0:t.title[m.value])||"暂无题面"}),b=T(0),f=async(t,_)=>{await navigator.clipboard.writeText(_),b.value=t,setTimeout(()=>{b.value==t&&(b.value=0)},1e3)};return(t,_)=>{const L=X("loading");return s(),h(l(K),{class:"problem-container"},{default:p(()=>[t.problem&&o.value?(s(),v(j,{key:0},[i("div",je,[i("h1",Be,k(u.value||"暂无数据"),1),i("div",Re,[i("span",Fe,"时间限制: "+k(l(ne)(t.problem.limitTime)),1),i("span",Ue,"内存限制: "+k(l(se)(t.problem.limitMemory)),1),i("span",Ae,k(l(ae)(t.problem.type)),1)])]),i("div",Ne,[o.value.background?(s(),v("div",Oe,[_[0]||(_[0]=i("h2",{class:"section-title"},"题目背景",-1)),r(M,{content:o.value.background},null,8,["content"])])):y("",!0),o.value.legend?(s(),v("div",qe,[_[1]||(_[1]=i("h2",{class:"section-title"},"题目描述",-1)),r(M,{content:o.value.legend},null,8,["content"])])):y("",!0),o.value.formatI?(s(),v("div",De,[_[2]||(_[2]=i("h2",{class:"section-title"},"输入格式",-1)),r(M,{content:o.value.formatI},null,8,["content"])])):y("",!0),o.value.formatO?(s(),v("div",ze,[_[3]||(_[3]=i("h2",{class:"section-title"},"输出格式",-1)),r(M,{content:o.value.formatO},null,8,["content"])])):y("",!0),o.value.examples&&o.value.examples.length>0?(s(),v("div",Je,[_[4]||(_[4]=i("h2",{class:"section-title"},"样例",-1)),(s(!0),v(j,null,Z(o.value.examples,($,g)=>(s(),v("div",{key:g,class:"example"},[r(l(ie),{gutter:8},{default:p(()=>[r(l(q),{span:12,class:"data"},{default:p(()=>[i("h3",null,[I(" 输入 #"+k(g+1)+" ",1),i("a",{href:"#",onClick:D(d=>f(g+1,$.dataI||""),["prevent"]),class:"copy-link"},[b.value!=g+1?(s(),h(l(V),{key:0,icon:l(z)},null,8,["icon"])):(s(),h(l(V),{key:1,icon:l(J)},null,8,["icon"]))],8,Ye)]),$.dataI?(s(),v("pre",Ge,k($.dataI),1)):y("",!0)]),_:2},1024),r(l(q),{span:12,class:"data"},{default:p(()=>[i("h3",null,[I(" 输出 #"+k(g+1)+" ",1),i("a",{href:"#",onClick:D(d=>f(-g-1,$.dataO||""),["prevent"]),class:"copy-link"},[b.value!=-g-1?(s(),h(l(V),{key:0,icon:l(z)},null,8,["icon"])):(s(),h(l(V),{key:1,icon:l(J)},null,8,["icon"]))],8,Xe)]),$.dataO?(s(),v("pre",Ke,k($.dataO),1)):y("",!0)]),_:2},1024)]),_:2},1024)]))),128))])):y("",!0),o.value.hint?(s(),v("div",Ze,[_[5]||(_[5]=i("h2",{class:"section-title"},"提示",-1)),r(M,{content:o.value.hint},null,8,["content"])])):y("",!0)])],64)):(s(),v(j,{key:1},[t.loading?H((s(),v("div",He,null,512)),[[L,!0]]):(s(),h(l(re),{key:1,description:"暂无题面"}))],64))]),_:1})}}}),We=F(Qe,[["__scopeId","data-v-d73679b8"]]),xe={class:"dialog-footer"},et=B({__name:"ProblemSubmit",props:ue({problem:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const n=U(),e=Q(),c=a,m=de(a,"modelValue"),{codeLangs:o}=G().config,u=me({lang:"",code:""}),b=T(!1),f=O(()=>u.lang&&u.code.trim().length>0),t=()=>{u.lang="",u.code=""},_=g=>{const d=g.raw;if(!d)return;const S=L(d.name);if(!u.lang){const w=Me(o,E=>E.ext.includes(S.toLowerCase()));w&&(u.lang=w.id)}const R=new FileReader;R.onload=w=>{var E;u.code=((E=w.target)==null?void 0:E.result)||""},R.readAsText(d)};function L(g){var S;const d=g.split(".");return d.length>1?`.${(S=d.pop())==null?void 0:S.toLowerCase()}`:""}const $=async()=>{if(f.value){b.value=!0;try{const g=await fe({problem:c.problem.id,lang:u.lang,code:u.code,contest:e.currentContest===null?void 0:e.currentContest.id});n.push(`/submission/${g.submission}`),m.value=!1}catch{}finally{b.value=!1}}};return(g,d)=>{const S=P("el-option"),R=P("el-select"),w=P("el-form-item"),E=P("el-input"),A=P("el-button"),W=P("el-upload"),x=P("el-form");return s(),h(l(pe),{modelValue:m.value,"onUpdate:modelValue":d[3]||(d[3]=C=>m.value=C),title:`提交代码 - ${g.problem.id}`,width:"800",onClose:t,"align-center":"","append-to-body":"","z-index":1e3},{footer:p(()=>[i("div",xe,[r(A,{onClick:d[2]||(d[2]=C=>m.value=!1)},{default:p(()=>d[5]||(d[5]=[I("取消")])),_:1}),r(A,{type:"primary",onClick:$,loading:b.value,disabled:!f.value},{default:p(()=>[r(l(V),{icon:l(be),class:"mr-2"},null,8,["icon"]),d[6]||(d[6]=I(" 提交评测 "))]),_:1},8,["loading","disabled"])])]),default:p(()=>[r(x,{model:u,"label-width":"auto"},{default:p(()=>[r(w,{label:"编程语言",required:""},{default:p(()=>[r(R,{modelValue:u.lang,"onUpdate:modelValue":d[0]||(d[0]=C=>u.lang=C),class:"input-lang",placeholder:"选择编程语言",size:"large",filterable:""},{default:p(()=>[(s(!0),v(j,null,Z(l(o),C=>(s(),h(S,{key:C.id,label:C.description,value:C.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(w,{label:"代码编辑",required:""},{default:p(()=>[r(E,{modelValue:u.code,"onUpdate:modelValue":d[1]||(d[1]=C=>u.code=C),autosize:{minRows:10,maxRows:12},class:"input-code",type:"textarea",placeholder:"Your code here..."},null,8,["modelValue"])]),_:1}),r(w,{label:"或者"},{default:p(()=>[r(W,{class:"upload-demo",action:"#","auto-upload":!1,"on-change":_,"show-file-list":!1},{default:p(()=>[r(A,{type:"primary"},{default:p(()=>[r(l(V),{icon:l(ce),class:"mr-2"},null,8,["icon"]),d[4]||(d[4]=I(" 上传代码文件 "))]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),tt=F(et,[["__scopeId","data-v-680eb99b"]]),ot={class:"panel-container"},lt={key:0,class:"description-list"},nt={class:"description-item"},st={class:"item-value"},at={class:"description-item"},it={class:"item-value"},rt={class:"description-item"},ut={class:"item-value"},dt={key:1,style:{height:"128px"}},mt=B({__name:"ProblemPanel",props:{problem:{},judgement:{},edit:{type:Boolean,default:!1},loading:{type:Boolean}},setup(a){const n=U(),e=_e(),c=T(!1);function m(){e.isAuthenticated?c.value=!0:e.show("login")}const o=a,u=()=>{o.problem&&n.push(`/submission?problem=${o.problem.id}`)},b=()=>{if(o.problem){if(!e.currentUser){e.show("login");return}n.push(`/submission?problem=${o.problem.id}&user=${e.currentUser.id}`)}};return(f,t)=>{const _=X("loading");return s(),v(j,null,[i("div",ot,[r(l(K),null,{default:p(()=>[t[4]||(t[4]=i("h3",{class:"info-title"},"题目信息",-1)),f.problem?(s(),v("div",lt,[i("div",nt,[t[1]||(t[1]=i("span",{class:"item-label"},"编号",-1)),i("span",st,k(f.problem.id),1)]),i("div",at,[t[2]||(t[2]=i("span",{class:"item-label"},"难度",-1)),i("span",it,k(f.problem.difficulty),1)]),i("div",rt,[t[3]||(t[3]=i("span",{class:"item-label"},"来源",-1)),i("span",ut,k(f.problem.provider),1)])])):H((s(),v("div",dt,null,512)),[[_,f.loading]])]),_:1}),r(l(N),{type:"primary",disabled:f.problem===null||!f.problem.hasTestdata,onClick:m},{default:p(()=>t[5]||(t[5]=[I("提交")])),_:1},8,["disabled"]),r(l(ve),{fill:"","fill-ratio":40},{default:p(()=>[r(l(N),{plain:"",onClick:u},{default:p(()=>t[6]||(t[6]=[I("全部记录")])),_:1}),r(l(N),{plain:"",onClick:b},{default:p(()=>t[7]||(t[7]=[I("我的记录")])),_:1})]),_:1})]),f.problem?(s(),h(tt,{key:0,problem:f.problem,modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=L=>c.value=L)},null,8,["problem","modelValue"])):y("",!0)],64)}}}),pt=F(mt,[["__scopeId","data-v-bec967af"]]),ct={key:0,class:"toolbar"},bt=B({__name:"ProblemToolbar",props:{problem:{},loading:{type:Boolean}},setup(a){const n=U();return(e,c)=>e.loading?y("",!0):(s(),v("div",ct,[e.problem?(s(),h(l(V),{key:0,icon:l(ge),class:"tool-icon"},null,8,["icon"])):y("",!0),e.problem?(s(),h(l(V),{key:1,icon:l(ye),class:"tool-icon",onClick:c[0]||(c[0]=m=>l(n).push(`/problem/${e.problem.id}/edit`))},null,8,["icon"])):y("",!0)]))}}),ft=F(bt,[["__scopeId","data-v-449d22aa"]]),yt=B({__name:"ViewProblemDetail",props:{plabel:{},pid_str:{},cid_str:{}},setup(a){U();const n=Q(),e=a,c=T(null),m=T(null),o=T(!1);async function u(){c.value=null,o.value=!0;let b=0;e.cid_str&&e.plabel?await n.enter(parseInt(e.cid_str)).then(()=>{b=n.currentContest.problems[e.plabel]}):e.pid_str&&(b=parseInt(e.pid_str)),b?await $e({problem:b}).then(f=>{c.value=f.problem,f.judgement&&(m.value=f.judgement)}).finally(()=>{o.value=!1}):o.value=!1}return he(()=>{u()}),ke(e,()=>u()),(b,f)=>(s(),h(Ce,{bread:[{label:"Reisen Online Judge",to:{name:"home"}},{label:"题目列表",to:{name:"problem-list"}},{label:`${e.pid_str?"#"+e.pid_str:"比赛 "+(e.cid_str??"")+" "+(e.plabel??"")}`}]},{main:p(()=>[r(ft,{loading:o.value,problem:c.value},null,8,["loading","problem"]),r(We,{loading:o.value,problem:c.value},null,8,["loading","problem"])]),sidebar:p(()=>[r(we),r(pt,{loading:o.value,problem:c.value,judgement:m.value},null,8,["loading","problem","judgement"])]),_:1},8,["bread"]))}});export{yt as default};
