import{Y as ee,Z as te,a as G,$ as oe,a0 as le,e as B,n as J,p as T,K as O,T as X,f as h,o as s,k as l,U as K,w as p,s as _,h as i,t as k,a1 as ne,a2 as se,a3 as ae,j as y,v as r,x as j,y as Z,a4 as q,g as I,a5 as D,F as V,a6 as z,a7 as Y,a8 as ie,X as H,a9 as re,_ as R,m as ue,aa as U,ab as Q,u as de,ac as me,r as P,ad as pe,ae as ce,af as be,ag as fe,J as ve,z as A,ah as _e,ai as ge,aj as ye,P as he,q as ke,ak as Ce,R as $e}from"./index-SVFsH89c.js";import{_ as M,C as we}from"./ContestSidebar-DBBe9pg8.js";import"./markdown-DVG_2iTS.js";var Ve=1/0,Ie=17976931348623157e292;function Pe(a){if(!a)return a===0?a:0;if(a=ee(a),a===Ve||a===-1/0){var n=a<0?-1:1;return n*Ie}return a===a?a:0}function Te(a){var n=Pe(a),t=n%1;return n===n?t?n-t:n:0}function Se(a){return function(n,t,c){var m=Object(n);if(!te(n)){var o=G(t);n=oe(n),t=function(b){return o(m[b],b,m)}}var u=a(n,t,c);return u>-1?m[o?n[u]:u]:void 0}}var Ee=Math.max;function Le(a,n,t){var c=a==null?0:a.length;if(!c)return-1;var m=t==null?0:Te(t);return m<0&&(m=Ee(c+m,0)),le(a,G(n),m)}var Me=Se(Le);const je={class:"problem-header"},Be={class:"problem-title"},Fe={class:"problem-meta"},Re={class:"time-limit"},Ue={class:"memory-limit"},Ne={class:"problem-type"},Ae={class:"problem-content"},Oe={key:0,class:"problem-section"},qe={key:1,class:"problem-section"},De={key:2,class:"problem-section"},ze={key:3,class:"problem-section"},Ye={key:4,class:"problem-section"},Ge=["onClick"],Je={key:0},Xe=["onClick"],Ke={key:0},Ze={key:5,class:"problem-section"},He={key:0,style:{height:"200px"}},Qe=B({__name:"ProblemContent",props:{problem:{},loading:{type:Boolean}},setup(a){const n=a,t=J();function c(){if(n.problem!==null){const e=Object.keys(n.problem.statements);if(e.length!==0&&!(t.userLang in e))return e[0]}return t.userLang}const m=T(c()),o=O(()=>{var e;return(e=n.problem)==null?void 0:e.statements[m.value]}),u=O(()=>{var e;return((e=n.problem)==null?void 0:e.title[m.value])||"暂无题面"}),b=T(0),f=async(e,v)=>{await navigator.clipboard.writeText(v),b.value=e,setTimeout(()=>{b.value==e&&(b.value=0)},1e3)};return(e,v)=>{const L=X("loading");return s(),h(l(K),{class:"problem-container"},{default:p(()=>[e.problem&&o.value?(s(),_(j,{key:0},[i("div",je,[i("h1",Be,k(u.value||"暂无数据"),1),i("div",Fe,[i("span",Re,"时间限制: "+k(l(ne)(e.problem.limitTime)),1),i("span",Ue,"内存限制: "+k(l(se)(e.problem.limitMemory)),1),i("span",Ne,k(l(ae)(e.problem.type)),1)])]),i("div",Ae,[o.value.background?(s(),_("div",Oe,[v[0]||(v[0]=i("h2",{class:"section-title"},"题目背景",-1)),r(M,{content:o.value.background},null,8,["content"])])):y("",!0),o.value.legend?(s(),_("div",qe,[v[1]||(v[1]=i("h2",{class:"section-title"},"题目描述",-1)),r(M,{content:o.value.legend},null,8,["content"])])):y("",!0),o.value.formatI?(s(),_("div",De,[v[2]||(v[2]=i("h2",{class:"section-title"},"输入格式",-1)),r(M,{content:o.value.formatI},null,8,["content"])])):y("",!0),o.value.formatO?(s(),_("div",ze,[v[3]||(v[3]=i("h2",{class:"section-title"},"输出格式",-1)),r(M,{content:o.value.formatO},null,8,["content"])])):y("",!0),o.value.examples&&o.value.examples.length>0?(s(),_("div",Ye,[v[4]||(v[4]=i("h2",{class:"section-title"},"样例",-1)),(s(!0),_(j,null,Z(o.value.examples,($,g)=>(s(),_("div",{key:g,class:"example"},[r(l(ie),{gutter:8},{default:p(()=>[r(l(q),{span:12,class:"data"},{default:p(()=>[i("h3",null,[I(" 输入 #"+k(g+1)+" ",1),i("a",{href:"#",onClick:D(d=>f(g+1,$.dataI||""),["prevent"]),class:"copy-link"},[b.value!=g+1?(s(),h(l(V),{key:0,icon:l(z)},null,8,["icon"])):(s(),h(l(V),{key:1,icon:l(Y)},null,8,["icon"]))],8,Ge)]),$.dataI?(s(),_("pre",Je,k($.dataI),1)):y("",!0)]),_:2},1024),r(l(q),{span:12,class:"data"},{default:p(()=>[i("h3",null,[I(" 输出 #"+k(g+1)+" ",1),i("a",{href:"#",onClick:D(d=>f(-g-1,$.dataO||""),["prevent"]),class:"copy-link"},[b.value!=-g-1?(s(),h(l(V),{key:0,icon:l(z)},null,8,["icon"])):(s(),h(l(V),{key:1,icon:l(Y)},null,8,["icon"]))],8,Xe)]),$.dataO?(s(),_("pre",Ke,k($.dataO),1)):y("",!0)]),_:2},1024)]),_:2},1024)]))),128))])):y("",!0),o.value.hint?(s(),_("div",Ze,[v[5]||(v[5]=i("h2",{class:"section-title"},"提示",-1)),r(M,{content:o.value.hint},null,8,["content"])])):y("",!0)])],64)):(s(),_(j,{key:1},[e.loading?H((s(),_("div",He,null,512)),[[L,!0]]):(s(),h(l(re),{key:1,description:"暂无题面"}))],64))]),_:1})}}}),We=R(Qe,[["__scopeId","data-v-d73679b8"]]),xe={class:"dialog-footer"},et=B({__name:"ProblemSubmit",props:ue({problem:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const n=U(),t=Q(),c=a,m=de(a,"modelValue"),{codeLangs:o}=J().config,u=me({lang:"",code:""}),b=T(!1),f=O(()=>u.lang&&u.code.trim().length>0),e=()=>{u.lang="",u.code=""},v=g=>{const d=g.raw;if(!d)return;const S=L(d.name);if(!u.lang){const w=Me(o,E=>E.ext.includes(S.toLowerCase()));w&&(u.lang=w.id)}const F=new FileReader;F.onload=w=>{var E;u.code=((E=w.target)==null?void 0:E.result)||""},F.readAsText(d)};function L(g){var S;const d=g.split(".");return d.length>1?`.${(S=d.pop())==null?void 0:S.toLowerCase()}`:""}const $=async()=>{if(f.value){b.value=!0;try{const g=await fe({problem:c.problem.id,lang:u.lang,code:u.code,contest:t.currentContest===null?void 0:t.currentContest.id});n.push(`/submission/${g.submission}`),m.value=!1}catch{}finally{b.value=!1}}};return(g,d)=>{const S=P("el-option"),F=P("el-select"),w=P("el-form-item"),E=P("el-input"),N=P("el-button"),W=P("el-upload"),x=P("el-form");return s(),h(l(pe),{modelValue:m.value,"onUpdate:modelValue":d[3]||(d[3]=C=>m.value=C),title:`提交代码 - ${g.problem.id}`,width:"800",onClose:e,"align-center":"","append-to-body":"","z-index":1e3},{footer:p(()=>[i("div",xe,[r(N,{onClick:d[2]||(d[2]=C=>m.value=!1)},{default:p(()=>d[5]||(d[5]=[I("取消")])),_:1}),r(N,{type:"primary",onClick:$,loading:b.value,disabled:!f.value},{default:p(()=>[r(l(V),{icon:l(be),class:"mr-2"},null,8,["icon"]),d[6]||(d[6]=I(" 提交评测 "))]),_:1},8,["loading","disabled"])])]),default:p(()=>[r(x,{model:u,"label-width":"auto"},{default:p(()=>[r(w,{label:"编程语言",required:""},{default:p(()=>[r(F,{modelValue:u.lang,"onUpdate:modelValue":d[0]||(d[0]=C=>u.lang=C),class:"input-lang",placeholder:"选择编程语言",size:"large",filterable:""},{default:p(()=>[(s(!0),_(j,null,Z(l(o),C=>(s(),h(S,{key:C.id,label:C.description,value:C.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(w,{label:"代码编辑",required:""},{default:p(()=>[r(E,{modelValue:u.code,"onUpdate:modelValue":d[1]||(d[1]=C=>u.code=C),autosize:{minRows:10,maxRows:12},class:"input-code",type:"textarea",placeholder:"Your code here..."},null,8,["modelValue"])]),_:1}),r(w,{label:"或者"},{default:p(()=>[r(W,{class:"upload-demo",action:"#","auto-upload":!1,"on-change":v,"show-file-list":!1},{default:p(()=>[r(N,{type:"primary"},{default:p(()=>[r(l(V),{icon:l(ce),class:"mr-2"},null,8,["icon"]),d[4]||(d[4]=I(" 上传代码文件 "))]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),tt=R(et,[["__scopeId","data-v-680eb99b"]]),ot={class:"panel-container"},lt={key:0,class:"description-list"},nt={class:"description-item"},st={class:"item-value"},at={class:"description-item"},it={class:"item-value"},rt={class:"description-item"},ut={class:"item-value"},dt={key:1,style:{height:"128px"}},mt=B({__name:"ProblemPanel",props:{problem:{},judgement:{},edit:{type:Boolean,default:!1},loading:{type:Boolean}},setup(a){const n=U(),t=ve(),c=T(!1);function m(){t.isAuthenticated?c.value=!0:t.show("login")}const o=a,u=()=>{o.problem&&n.push(`/submission?problem=${o.problem.id}`)},b=()=>{if(o.problem){if(!t.currentUser){t.show("login");return}n.push(`/submission?problem=${o.problem.id}&user=${t.currentUser.id}`)}};return(f,e)=>{const v=X("loading");return s(),_(j,null,[i("div",ot,[r(l(K),null,{default:p(()=>[e[4]||(e[4]=i("h3",{class:"info-title"},"题目信息",-1)),f.problem?(s(),_("div",lt,[i("div",nt,[e[1]||(e[1]=i("span",{class:"item-label"},"编号",-1)),i("span",st,k(f.problem.id),1)]),i("div",at,[e[2]||(e[2]=i("span",{class:"item-label"},"难度",-1)),i("span",it,k(f.problem.difficulty),1)]),i("div",rt,[e[3]||(e[3]=i("span",{class:"item-label"},"来源",-1)),i("span",ut,k(f.problem.provider),1)])])):H((s(),_("div",dt,null,512)),[[v,f.loading]])]),_:1}),r(l(A),{type:"primary",disabled:f.problem===null||!f.problem.hasTestdata,onClick:m},{default:p(()=>e[5]||(e[5]=[I("提交")])),_:1},8,["disabled"]),r(l(_e),{fill:"","fill-ratio":40},{default:p(()=>[r(l(A),{plain:"",onClick:u},{default:p(()=>e[6]||(e[6]=[I("全部记录")])),_:1}),r(l(A),{plain:"",onClick:b},{default:p(()=>e[7]||(e[7]=[I("我的记录")])),_:1})]),_:1})]),f.problem?(s(),h(tt,{key:0,problem:f.problem,modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=L=>c.value=L)},null,8,["problem","modelValue"])):y("",!0)],64)}}}),pt=R(mt,[["__scopeId","data-v-bec967af"]]),ct={key:0,class:"toolbar"},bt=B({__name:"ProblemToolbar",props:{problem:{},loading:{type:Boolean}},setup(a){const n=U();return(t,c)=>t.loading?y("",!0):(s(),_("div",ct,[t.problem?(s(),h(l(V),{key:0,icon:l(ge),class:"tool-icon"},null,8,["icon"])):y("",!0),t.problem?(s(),h(l(V),{key:1,icon:l(ye),class:"tool-icon",onClick:c[0]||(c[0]=m=>l(n).push(`/problem/${t.problem.id}/edit`))},null,8,["icon"])):y("",!0)]))}}),ft=R(bt,[["__scopeId","data-v-449d22aa"]]),yt=B({__name:"ViewProblemDetail",props:{plabel:{},pid_str:{},cid_str:{}},setup(a){U();const n=Q(),t=a,c=T(null),m=T(null),o=T(!1);async function u(){c.value=null,o.value=!0;let b=0;t.cid_str&&t.plabel?await n.enter(parseInt(t.cid_str)).then(()=>{b=n.currentContest.problems[t.plabel]}):t.pid_str&&(b=parseInt(t.pid_str)),b?await $e({problem:b}).then(f=>{c.value=f.problem,f.judgement&&(m.value=f.judgement)}).finally(()=>{o.value=!1}):o.value=!1}return he(()=>{u()}),ke(t,()=>u()),(b,f)=>(s(),h(Ce,null,{main:p(()=>[r(ft,{loading:o.value,problem:c.value},null,8,["loading","problem"]),r(We,{loading:o.value,problem:c.value},null,8,["loading","problem"])]),sidebar:p(()=>[r(we),r(pt,{loading:o.value,problem:c.value,judgement:m.value},null,8,["loading","problem","judgement"])]),_:1}))}});export{yt as default};
